<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hello World.</title>
</head>
<body>
<section id="nice" data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px; color: black; padding: 0 10px; line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; word-break: break-word; word-wrap: break-word; text-align: left; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;"><h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 24px;"><span class="prefix" style="display: none;"></span><span class="content">Song Parser Demo of Java SPI</span><span class="suffix"></span></h1>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;"><a href="README-zh.md" style="text-decoration: none; color: #1e6bb8; word-wrap: break-word; font-weight: bold; border-bottom: 1px solid #1e6bb8;">中文版点击这里</a></p>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">song-parser-spi-demo is a simple example of Java SPI usage. It can reinfoce your understanding of Java SPI mechanism.</p>
    <h2 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; font-weight: bold; font-size: 22px; letter-spacing: 5px; padding: 20px; color: #000d83; text-align: center; background-image: url(https://shuyi-tech-blog.oss-cn-shenzhen.aliyuncs.com/halo_blog_system_file/%E9%99%88%E6%A0%91%E4%B9%89%20-%20%E6%8E%92%E7%89%88%E5%BA%95%E5%9B%BE%20-%20CSY.png); background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-position: center -10px; background-size: 150px;"><span class="prefix" style="display: none;"></span><span class="content" style="padding-bottom: 12px; border-bottom: 2px solid #000d83;">Background</span><span class="suffix"></span></h2>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">As we know, there is many kinds of song format, a song can be MP3 or MP4 or even RMBV format. We want to build a framework to parse the song information which contains song name, song author, song elasped time etc. If we don't use Java SPI mechanism, we can develop the framework like this:</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">public&nbsp;class&nbsp;ParseUtil{<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Song&nbsp;parseMp3Song(byte[]&nbsp;data){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//parse&nbsp;song&nbsp;according&nbsp;to&nbsp;mp3&nbsp;data&nbsp;format<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">people who use the framwork write the code below to get the song infomation:</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">Song&nbsp;song&nbsp;=&nbsp;ParseUtil.parseMp3Song(data);<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">and if there is another song which is stored by mp4 format, we need to upgrade our framework and release a new version, and the framework now like this:</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">public&nbsp;class&nbsp;ParseUtil{<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Song&nbsp;parseMp3Song(byte[]&nbsp;data){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//parse&nbsp;song&nbsp;according&nbsp;to&nbsp;mp3&nbsp;data&nbsp;format<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Song&nbsp;parseMp4Song(byte[]&nbsp;data){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//parse&nbsp;song&nbsp;according&nbsp;to&nbsp;mp4&nbsp;data&nbsp;format<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">and people who use it need to change their code like this:</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">//this&nbsp;song&nbsp;is&nbsp;mp3&nbsp;format&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">type</span>,&nbsp;call&nbsp;the&nbsp;parseMp3Song()&nbsp;method.<br>Song&nbsp;song&nbsp;=&nbsp;ParseUtil.parseMp3Song(data);<br>//this&nbsp;song&nbsp;is&nbsp;mp4&nbsp;format&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">type</span>,&nbsp;call&nbsp;the&nbsp;parseMp4Song()&nbsp;method.<br>Song&nbsp;song&nbsp;=&nbsp;ParseUtil.parseMp4Song(data);<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">everytime we add a new song format parser, we need to release a new version of the framework, and everyone who want to use our new version need to upgrade the framework. What's more, people who use the framework need to know the song format and call the corresponding method. It's so unconvenient!</p>
    <h2 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; font-weight: bold; font-size: 22px; letter-spacing: 5px; padding: 20px; color: #000d83; text-align: center; background-image: url(https://shuyi-tech-blog.oss-cn-shenzhen.aliyuncs.com/halo_blog_system_file/%E9%99%88%E6%A0%91%E4%B9%89%20-%20%E6%8E%92%E7%89%88%E5%BA%95%E5%9B%BE%20-%20CSY.png); background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-position: center -10px; background-size: 150px;"><span class="prefix" style="display: none;"></span><span class="content" style="padding-bottom: 12px; border-bottom: 2px solid #000d83;">Better Framework with SPI</span><span class="suffix"></span></h2>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">but if we use Java SPI mechanism, everytime we add a new song format parser, people who use the Song Parser Framework don't need to upgrade the framework and don't need to change any of their code.</p>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">when there is only one kinds of format type, for example, mp3 format type. we write the code below to parse the song information.</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">Song&nbsp;song&nbsp;=&nbsp;ParserManager.getSong(data);&nbsp;&nbsp;&nbsp;&nbsp;//song&nbsp;stored&nbsp;with&nbsp;mp3&nbsp;format<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">and if we want to parse song with mp4 format, we don't need to change the calling method, the code parse the song information is still like:</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">Song&nbsp;song&nbsp;=&nbsp;ParserManager.getSong(data);&nbsp;&nbsp;&nbsp;&nbsp;//song&nbsp;stored&nbsp;with&nbsp;mp3&nbsp;format<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">what we need to do is import the mp4 Parser dependency, and the Java SPI mechanism will find out all the parser and auto search the right parser to parse the song.</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">&lt;dependency&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;com.xiaoshu.demo&lt;/groupId&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;song-parser-mp4&lt;/artifactId&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;1.0.0&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">It's really awesome!</p>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">we don't need to change any of our code but just import the Parser dependency and it will return the right result.</p>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">Let's go inside the Song Parser Framework and see how it works.</p>
    <h2 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; font-weight: bold; font-size: 22px; letter-spacing: 5px; padding: 20px; color: #000d83; text-align: center; background-image: url(https://shuyi-tech-blog.oss-cn-shenzhen.aliyuncs.com/halo_blog_system_file/%E9%99%88%E6%A0%91%E4%B9%89%20-%20%E6%8E%92%E7%89%88%E5%BA%95%E5%9B%BE%20-%20CSY.png); background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-position: center -10px; background-size: 150px;"><span class="prefix" style="display: none;"></span><span class="content" style="padding-bottom: 12px; border-bottom: 2px solid #000d83;">Framework Structure</span><span class="suffix"></span></h2>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">This project contains four separate modules which can divide into three main part.</p>
    <ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
        <li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">"song-parser" module, define the unified interaface that every parser will use.</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">"song-parser-mp3" module, define the mp3 parser.</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">"song-parser-demo" module, provide a quicks start example, you can just run the "com.chenshuyi.demo.App.main" and result comes.</section></li></ul>
    <h2 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; font-weight: bold; font-size: 22px; letter-spacing: 5px; padding: 20px; color: #000d83; text-align: center; background-image: url(https://shuyi-tech-blog.oss-cn-shenzhen.aliyuncs.com/halo_blog_system_file/%E9%99%88%E6%A0%91%E4%B9%89%20-%20%E6%8E%92%E7%89%88%E5%BA%95%E5%9B%BE%20-%20CSY.png); background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-position: center -10px; background-size: 150px;"><span class="prefix" style="display: none;"></span><span class="content" style="padding-bottom: 12px; border-bottom: 2px solid #000d83;">how to add a new Parser</span><span class="suffix"></span></h2>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">if you want to add a new song Parser, for example a Parser to parse RMVB format type song. You need to create a new project and add the dependency of "song-parser":</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">&lt;dependency&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;com.chenshuyi.demo&lt;/groupId&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;song-parser&lt;/artifactId&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;1.0.0&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">and then create a class called "Parser" in the root of package:</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">package&nbsp;com.anonymous.demo;<br><br>import&nbsp;com.chenshuyi.demo.ParserManager;<br><br>/**<br>&nbsp;*&nbsp;@author&nbsp;chenyr<br>&nbsp;*&nbsp;@date&nbsp;2018.04.19<br>&nbsp;*/<br>public&nbsp;class&nbsp;Parser&nbsp;extends&nbsp;RmvbParser&nbsp;implements&nbsp;com.chenshuyi.demo.Parser&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;static<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ParserManager.registerParser(new&nbsp;Parser());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch&nbsp;(Exception&nbsp;e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;RuntimeException(<span class="hljs-string" style="color: #98c379; line-height: 26px;">"Can't&nbsp;register&nbsp;parser!"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">and then create the RmvbParser which do the data parse work:</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">package&nbsp;com.anonymous.demo;<br><br>import&nbsp;com.chenshuyi.demo.Song;<br><br>import&nbsp;java.util.Arrays;<br><br>/**<br>&nbsp;*&nbsp;@author&nbsp;chenyr<br>&nbsp;*&nbsp;@date&nbsp;2018.04.19<br>&nbsp;*/<br>public&nbsp;class&nbsp;RmvbParser&nbsp;implements&nbsp;com.chenshuyi.demo.Parser&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;byte[]&nbsp;FORMAT&nbsp;=&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">"RMVB"</span>.getBytes();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;int&nbsp;FORMAT_LENGTH&nbsp;=&nbsp;FORMAT.length;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Song&nbsp;parse(byte[]&nbsp;data)&nbsp;throws&nbsp;Exception{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">if</span>&nbsp;(!isDataCompatible(data))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;Exception(<span class="hljs-string" style="color: #98c379; line-height: 26px;">"data&nbsp;format&nbsp;is&nbsp;wrong."</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//parse&nbsp;data&nbsp;by&nbsp;rmvb&nbsp;format&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">type</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">return</span>&nbsp;new&nbsp;Song(<span class="hljs-string" style="color: #98c379; line-height: 26px;">"AGA"</span>,&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">"rmvb"</span>,&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">"《Wonderful&nbsp;U》"</span>,&nbsp;240L);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;boolean&nbsp;isDataCompatible(byte[]&nbsp;data)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[]&nbsp;format&nbsp;=&nbsp;Arrays.copyOfRange(data,&nbsp;0,&nbsp;FORMAT_LENGTH);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">return</span>&nbsp;Arrays.equals(format,&nbsp;FORMAT);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">finanly add a description file <code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;">resources/META-INF/services/com.chenshuyi.demo.Parser</code>:</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">com.anonymous.demo.Parser<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">and then you import the new mp4 Parser in module "song-parser-demo":</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">&lt;dependency&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;com.anonymous.demo&lt;/groupId&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;song-parser-rmvb&lt;/artifactId&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;1.0.0&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">and then try to parse rmvb format song:</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">Song&nbsp;song&nbsp;=&nbsp;ParserManager.getSong(data);&nbsp;&nbsp;&nbsp;&nbsp;//parse&nbsp;rmvb&nbsp;song&nbsp;<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">and it works !</p>
    <pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">Name:《Wonderful&nbsp;U》<br>Author:AGA<br>Time:240<br>Format:rmvb<br></code></pre>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">for more detail, you can dive into the code and thanks for watching.</p>
    <p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; color: black; line-height: 2em;">if it helps you understand the Java SPI, please give me a start, thank you.</p>
</section>
</body>
</html>